import { useState, useEffect } from "react";
import Header from "./components/header/Header";
import ClientsSection from "./components/clientsSection/ClientsSection";
import ShowcaseSection from "./components/ShowcaseSection";
import ReviewSection from "./components/reviewSection/ReviewSection";
import DiscoverSection from "./components/DiscoverSection";
import Footer from "./components/footer/Footer";

function App() {
  const allClients = [
    {
      id: 1,
      name: "Allianz",
      logo: "/pentest-tools-customers-page-redesign/img/allianz_bank.png",
      industry: "banking&Finance",
      country: "germany",
      relevance: 7,
    },
    {
      id: 2,
      name: "Cathay United Bank",
      logo: "/pentest-tools-customers-page-redesign/img/cathay.png",
      industry: "banking&Finance",
      country: "china",
      relevance: 1,
    },
    {
      id: 3,
      name: "Yale University",
      logo: "/pentest-tools-customers-page-redesign/img/yale.png",
      industry: "education",
      country: "unitedStatesOfAmerica",
      relevance: 10,
    },
    {
      id: 4,
      name: "Johnson & Johnson",
      logo: "/pentest-tools-customers-page-redesign/img/jnj.png",
      industry: "healthcare",
      country: "unitedKingdom",
      relevance: 8,
    },
    {
      id: 5,
      name: "Accenture",
      logo: "/pentest-tools-customers-page-redesign/img/accenture.png",
      industry: "audit&Advisory",
      country: "unitedKingdom",
      relevance: 7,
    },
    {
      id: 6,
      name: "Deloitte",
      logo: "/pentest-tools-customers-page-redesign/img/deloitte.png",
      industry: "audit&Advisory",
      country: "unitedKingdom",
      relevance: 7,
    },
    {
      id: 7,
      name: "Intel",
      logo: "/pentest-tools-customers-page-redesign/img/intel.png",
      industry: "technology&Telecom",
      country: "unitedStatesOfAmerica",
      relevance: 10,
    },
    {
      id: 8,
      name: "Orange",
      logo: "/pentest-tools-customers-page-redesign/img/orange.png",
      industry: "technology&Telecom",
      country: "france",
      relevance: 9,
    },
    {
      id: 9,
      name: "Vodafone",
      logo: "/pentest-tools-customers-page-redesign/img/vodafone.png",
      industry: "technology&Telecom",
      country: "unitedKingdom",
      relevance: 9,
    },
    {
      id: 10,
      name: "U.S. Department of Commerce",
      logo: "/pentest-tools-customers-page-redesign/img/doc.png",
      industry: "gov&PublicSector",
      country: "unitedStatesOfAmerica",
      relevance: 10,
    },
  ];

  const [clients, setClients] = useState([...allClients]);

  const [filters, setFilters] = useState([
    { category: "industry", value: "allIndustries" },
    { category: "country", value: "allCountries" },
    { category: "sort", value: "relevance" },
  ]);

  useEffect(() => {
    setClients([...allClients.filter(reduce).sort(compare)]);

    function compare(a, b) {
      if (filters[2].value === "alphabetical") {
        return a.name.localeCompare(b.name);
      } else {
        if (a.relevance < b.relevance) return 1;
        if (a.relevance === b.relevance) return 0;
        if (a.relevance > b.relevance) return -1;
      }
    }

    function reduce(client) {
      switch (true) {
        case filters[0].value === "allIndustries" &&
          filters[1].value === "allCountries":
        case filters[0].value === "allIndustries" &&
          filters[1].value === client.country:
        case filters[0].value === client.industry &&
          filters[1].value === "allCountries":
        case filters[0].value === client.industry &&
          filters[1].value === client.country:
          return true;
        default:
          return false;
      }
    }
  }, [filters]);

  const onChangeInput = (category, value) => {
    setFilters(
      filters.map((filter) => {
        return filter.category === category
          ? { ...filter, value: value }
          : filter;
      })
    );
  };

  return (
    <div className="App">
      <Header />
      <ShowcaseSection />
      <ClientsSection
        clients={clients}
        filters={filters}
        onChange={onChangeInput}
      />
      <hr />
      <ReviewSection />
      <DiscoverSection />
      <Footer />
    </div>
  );
}

export default App;
